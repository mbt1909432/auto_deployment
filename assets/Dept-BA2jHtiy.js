var v=(x,w,p)=>new Promise((_,g)=>{var h=i=>{try{u(p.next(i))}catch(c){g(c)}},k=i=>{try{u(p.throw(i))}catch(c){g(c)}},u=i=>i.done?_(i.value):Promise.resolve(i.value).then(h,k);u((p=p.apply(x,w)).next())});import{g as T,d as N,a as I,p as P}from"./dept-D9OxYoIk.js";import{u as J,_ as M}from"./Table.vue_vue_type_script_lang-DhqtaXqw.js";import{d as O,t as m}from"./index-YxwiwpWh.js";/* empty css                  *//* empty css               */import{_ as U}from"./ContentWrap.vue_vue_type_script_setup_true_lang-PmTq9VSX.js";import{_ as W}from"./Write.vue_vue_type_script_setup_true_lang-ZkrcjkUz.js";import{_ as X}from"./Dialog.vue_vue_type_style_index_0_lang-h2LFKN_R.js";import{z as j,n as q,h as G}from"./element-plus-c7Yb662V.js";import{l as H,J as K,O as l,P as R,V as f,a as r,m as V,p as Q,R as s,u as a,S as Y,W as S,X as Z}from"./vue-chunks-DM5Q6aJS.js";/* empty css                       *//* empty css                 *//* empty css                   *//* empty css                        *//* empty css               */import"./el-tooltip-l0sNRNKZ.js";/* empty css                  */import"./useForm-LIKgH9QM.js";/* empty css                          *//* empty css                       *//* empty css                       *//* empty css                *//* empty css                   *//* empty css                    */import"./style.css_vue_type_style_index_0_src_true_lang-DrgVQkG7.js";import"./wang-editor-kNnY1XhY.js";/* empty css                   *//* empty css                    *//* empty css                        *//* empty css                *//* empty css                         */import"./_Uint8Array-DKqHwQen.js";import"./useValidator-dibMbM3d.js";const Be=H({name:"AuthDept",__name:"Dept",setup(x){const{t:w}=O(),{tableRegister:p,tableState:_,tableMethods:g}=J({fetchDataApi:()=>v(this,null,function*(){const{pageSize:e,currentPage:t}=_,o=yield T({page:a(t),limit:a(e)});return{list:o.data||[],total:o.count||0}}),fetchDelApi:e=>v(this,null,function*(){return(yield N(e)).code===200})}),{dataList:h,loading:k}=_,{getList:u,delList:i}=g,c=K([{field:"name",label:"部门名称",disabled:!0,show:!0},{field:"dept_key",label:"部门标识",show:!0},{field:"owner",label:"负责人",show:!0},{field:"phone",label:"联系电话",show:!0},{field:"email",label:"邮箱",show:!0},{field:"desc",label:"描述",show:!0},{field:"order",label:"排序",width:"120px",show:!0},{field:"disabled",label:"是否禁用",width:"120px",show:!0,slots:{default:e=>{const t=e.row;return l(R,null,[l(j,{modelValue:!t.disabled,disabled:!0},null)])}}},{field:"action",width:"200px",label:"操作",show:!0,slots:{default:e=>{const t=e.row;return l(R,null,[l(m,{type:"primary",link:!0,size:"small",onClick:()=>$(t)},{default:()=>[f("编辑")]}),l(m,{type:"primary",link:!0,size:"small",onClick:()=>B(t)},{default:()=>[f("添加子部门")]}),l(m,{type:"danger",loading:D.value,link:!0,size:"small",onClick:()=>E(t)},{default:()=>[f("删除")]})])}}}]),D=r(!1),E=e=>v(this,null,function*(){D.value=!0,yield i(!0,[e.id]).finally(()=>{D.value=!1})}),n=r(!1),y=r(""),b=r(),A=r(void 0),d=r(""),L=r(),C=r(!1),$=e=>{y.value="编辑",d.value="edit",b.value=e,n.value=!0},z=()=>{y.value="新增",d.value="add",b.value=void 0,n.value=!0},B=e=>{y.value="添加子部门",d.value="addSon",A.value=e.id,b.value=void 0,n.value=!0},F=()=>v(this,null,function*(){const e=a(L),t=yield e==null?void 0:e.submit();if(t){C.value=!0;try{const o=r({});d.value==="add"||d.value==="addSon"?(o.value=yield I(t),o.value&&(A.value=void 0,n.value=!1,u())):d.value==="edit"&&(o.value=yield P(t),o.value&&(n.value=!1,u()))}finally{C.value=!1}}});return(e,t)=>(V(),Q(R,null,[l(a(U),null,{default:s(()=>[l(a(M),{columns:c,showAction:"","default-expand-all":"","node-key":"id",data:a(h),loading:a(k),onRegister:a(p),onRefresh:a(u)},{toolbar:s(()=>[l(a(q),{gutter:10},{default:s(()=>[l(a(G),{span:1.5},{default:s(()=>[l(a(m),{type:"primary",onClick:z},{default:s(()=>[f("新增部门")]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","data","loading","onRegister","onRefresh"])]),_:1}),l(a(X),{modelValue:n.value,"onUpdate:modelValue":t[1]||(t[1]=o=>n.value=o),title:y.value},{footer:s(()=>[d.value!=="detail"?(V(),Y(a(m),{key:0,type:"primary",loading:C.value,onClick:F},{default:s(()=>[f(S(a(w)("exampleDemo.save")),1)]),_:1},8,["loading"])):Z("",!0),l(a(m),{onClick:t[0]||(t[0]=o=>n.value=!1)},{default:s(()=>[f(S(a(w)("dialogDemo.close")),1)]),_:1})]),default:s(()=>[l(W,{ref_key:"writeRef",ref:L,"current-row":b.value,"parent-id":A.value},null,8,["current-row","parent-id"])]),_:1},8,["modelValue","title"])],64))}});export{Be as default};
